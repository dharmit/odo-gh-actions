"use strict";(self.webpackChunkodo_dev=self.webpackChunkodo_dev||[]).push([[3229],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>u});var o=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,o,a=function(e,n){if(null==e)return{};var t,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var p=o.createContext({}),d=function(e){var n=o.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},c=function(e){var n=d(e.components);return o.createElement(p.Provider,{value:n},e.children)},s={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},m=o.forwardRef((function(e,n){var t=e.components,a=e.mdxType,r=e.originalType,p=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),m=d(t),u=a,f=m["".concat(p,".").concat(u)]||m[u]||s[u]||r;return t?o.createElement(f,i(i({ref:n},c),{},{components:t})):o.createElement(f,i({ref:n},c))}));function u(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var r=t.length,i=new Array(r);i[0]=m;var l={};for(var p in n)hasOwnProperty.call(n,p)&&(l[p]=n[p]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var d=2;d<r;d++)i[d]=t[d];return o.createElement.apply(null,i)}return o.createElement.apply(null,t)}m.displayName="MDXCreateElement"},9547:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>i,default:()=>s,frontMatter:()=>r,metadata:()=>l,toc:()=>d});var o=t(3117),a=(t(7294),t(3905));const r={title:"odo deploy"},i=void 0,l={unversionedId:"command-reference/deploy",id:"command-reference/deploy",title:"odo deploy",description:"odo can be used to deploy components in a similar manner they would be deployed by a CI/CD system,",source:"@site/docs/command-reference/deploy.md",sourceDirName:"command-reference",slug:"/command-reference/deploy",permalink:"/odo-gh-actions/docs/command-reference/deploy",editUrl:"https://github.com/redhat-developer/odo/edit/main/docs/website/docs/command-reference/deploy.md",tags:[],version:"current",frontMatter:{title:"odo deploy"},sidebar:"tutorialSidebar",previous:{title:"odo delete namespace",permalink:"/odo-gh-actions/docs/command-reference/delete-namespace"},next:{title:"odo describe binding",permalink:"/odo-gh-actions/docs/command-reference/describe-binding"}},p={},d=[{value:"Substituting variables",id:"substituting-variables",level:2},{value:"Env File",id:"env-file",level:2}],c={toc:d};function s(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,o.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"odo can be used to deploy components in a similar manner they would be deployed by a CI/CD system,\nby first building the images of the containers to deploy, then by deploying the Kubernetes resources\nnecessary to deploy the components."),(0,a.kt)("p",null,"When running the command ",(0,a.kt)("inlineCode",{parentName:"p"},"odo deploy"),", odo searches for the default command of kind ",(0,a.kt)("inlineCode",{parentName:"p"},"deploy")," in the devfile, and executes this command.\nThe kind ",(0,a.kt)("inlineCode",{parentName:"p"},"deploy")," is supported by the devfile format starting from version 2.2.0."),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"deploy")," command is typically a ",(0,a.kt)("em",{parentName:"p"},"composite")," command, composed of several ",(0,a.kt)("em",{parentName:"p"},"apply")," commands:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"a command referencing an ",(0,a.kt)("inlineCode",{parentName:"li"},"image")," component that, when applied, will build the image of the container to deploy, and push it to its registry,"),(0,a.kt)("li",{parentName:"ul"},"a command referencing a ",(0,a.kt)("a",{parentName:"li",href:"https://devfile.io/docs/devfile/2.2.0/user-guide/adding-a-kubernetes-or-openshift-component-to-a-devfile"},(0,a.kt)("inlineCode",{parentName:"a"},"kubernetes")," component")," that, when applied, will create a Kubernetes resource in the cluster.")),(0,a.kt)("p",null,"With the following example ",(0,a.kt)("inlineCode",{parentName:"p"},"devfile.yaml")," file, a container image will be built by using the ",(0,a.kt)("inlineCode",{parentName:"p"},"Dockerfile")," present in the directory,\nthe image will be pushed to its registry and a Kubernetes Deployment will be created in the cluster, using this freshly built image."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'schemaVersion: 2.2.0\n[...]\nvariables:\n  CONTAINER_IMAGE: quay.io/phmartin/myimage\ncommands:\n  - id: build-image\n    apply:\n      component: outerloop-build\n  - id: deployk8s\n    apply:\n      component: outerloop-deploy\n  - id: deploy\n    composite:\n      commands:\n        - build-image\n        - deployk8s\n      group:\n        kind: deploy\n        isDefault: true\ncomponents:\n  - name: outerloop-build\n    image:\n      imageName: "{{CONTAINER_IMAGE}}"\n      dockerfile:\n        uri: ./Dockerfile\n        buildContext: ${PROJECTS_ROOT}\n  - name: outerloop-deploy\n    kubernetes:\n      inlined: |\n        kind: Deployment\n        apiVersion: apps/v1\n        metadata:\n          name: my-component\n        spec:\n          replicas: 1\n          selector:\n            matchLabels:\n              app: node-app\n          template:\n            metadata:\n              labels:\n                app: node-app\n            spec:\n              containers:\n                - name: main\n                  image: {{CONTAINER_IMAGE}}\n')),(0,a.kt)("p",null,"Note that the ",(0,a.kt)("inlineCode",{parentName:"p"},"uri")," for the Dockerfile could also be an HTTP or HTTPS URL."),(0,a.kt)("h2",{id:"substituting-variables"},"Substituting variables"),(0,a.kt)("p",null,"The Devfile can define variables to make the Devfile parameterizable. The Devfile can define values for these variables, and you\ncan override the values for variables from the command line when running ",(0,a.kt)("inlineCode",{parentName:"p"},"odo deploy"),", using the ",(0,a.kt)("inlineCode",{parentName:"p"},"--var")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"--var-file")," options."),(0,a.kt)("p",null,"See ",(0,a.kt)("a",{parentName:"p",href:"/odo-gh-actions/docs/command-reference/dev#substituting-variables"},"Substituting variables in odo dev")," for more information."),(0,a.kt)("h2",{id:"env-file"},"Env File"),(0,a.kt)("p",null,"When ",(0,a.kt)("inlineCode",{parentName:"p"},"odo deploy")," is executed, a ",(0,a.kt)("inlineCode",{parentName:"p"},".odo/env/env.yaml")," file is created if it does not exist. It stores the namespace/project that will be used by the component, and its default value is set to currently active namespace/project."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},"ComponentSettings:\n  Project: myproject\n")),(0,a.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"Creating, deleting or setting a namespace/project will not modify this value. To use a different namespace/project, user will have to manually change ",(0,a.kt)("inlineCode",{parentName:"p"},".ComponentSettings.Project")," value, or delete the ",(0,a.kt)("inlineCode",{parentName:"p"},".odo")," directory."))))}s.isMDXComponent=!0}}]);